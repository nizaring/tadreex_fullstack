{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/firas halouani/Desktop/design/Tadreex/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/firas halouani/Desktop/design/Tadreex/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/firas halouani/Desktop/design/Tadreex/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useShoppingCart}from\"../context/ShoppingCartContext\";import FormatCurrency from\"../Admin/formation/FormatCurrency\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CartItem=function CartItem(_ref){var id=_ref.id,quantity=_ref.quantity,company_id=_ref.company_id;var _useShoppingCart=useShoppingCart(),removeFromCart=_useShoppingCart.removeFromCart;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),item=_useState2[0],setItem=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isPurchased=_useState4[0],setIsPurchased=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isDisabled=_useState6[0],setIsDisabled=_useState6[1];useEffect(function(){var fetchItem=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"http://localhost:3000/training-courses/\".concat(id));case 3:response=_context.sent;if(response.ok){_context.next=6;break;}throw new Error(\"Network response was not ok\");case 6:_context.next=8;return response.json();case 8:data=_context.sent;setItem(data);_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 15:case\"end\":return _context.stop();}},_callee,null,[[0,12]]);}));return function fetchItem(){return _ref2.apply(this,arguments);};}();fetchItem();// Récupération des formations achetées par l'entreprise\naxios.get(\"http://localhost:3000/company/\".concat(company_id,\"/courses\")).then(function(response){var purchasedCourses=response.data.map(function(course){return course.course_id;});if(purchasedCourses.includes(id)){setIsPurchased(true);setIsDisabled(true);// désactiver le bouton \"&times;\"\n}}).catch(function(error){console.error(error);});},[id,company_id]);var handleBuyClick=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(courseId){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.post(\"http://localhost:3000/company/\".concat(company_id,\"/cours/\").concat(courseId),{isPurchased:true,inProgress:false});case 3:setIsPurchased(true);setIsDisabled(true);// désactiver le bouton \"&times;\"\n_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](0);console.error(_context2.t0);case 10:case\"end\":return _context2.stop();}},_callee2,null,[[0,7]]);}));return function handleBuyClick(_x){return _ref3.apply(this,arguments);};}();var handleRemoveClick=function handleRemoveClick(courseId){if(!isDisabled&&!isPurchased){// Vérifier si le bouton \"&times;\" et le bouton \"Acheter\" sont activés\nremoveFromCart(courseId);}};if(item==null)return null;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 items-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:3000/\".concat(item.image),alt:\"cart-img\",style:{width:\"70px\",height:\"75px\",objectFit:\"cover\"}}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-grow\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-lg\",children:[item.title,\" \"]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 text-sm\"})]}),/*#__PURE__*/_jsx(\"div\",{children:FormatCurrency(item.price*quantity)}),!isPurchased&&/*#__PURE__*/_jsx(\"button\",{className:\"text-red-500 bg-transparent border border-red-500 rounded hover:bg-red-500 hover:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\",onClick:function onClick(){return handleRemoveClick(item.course_id);},disabled:isDisabled,children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleBuyClick(item.course_id);},className:\"bg-green-500 hover:bg-green-700 text-white py-2 px-2 rounded\",disabled:isPurchased,style:{backgroundColor:isPurchased?\"#838996\":\"\"},children:isPurchased?\"In progress\":\"Demand\"}),/*#__PURE__*/_jsx(\"button\",{className:\"bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded\",children:\"payer\"})]});};export default CartItem;","map":{"version":3,"names":["React","useState","useEffect","useShoppingCart","FormatCurrency","axios","jsx","_jsx","jsxs","_jsxs","CartItem","_ref","id","quantity","company_id","_useShoppingCart","removeFromCart","_useState","_useState2","_slicedToArray","item","setItem","_useState3","_useState4","isPurchased","setIsPurchased","_useState5","_useState6","isDisabled","setIsDisabled","fetchItem","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","data","wrap","_callee$","_context","prev","next","fetch","concat","sent","ok","Error","json","t0","console","error","stop","apply","arguments","get","then","purchasedCourses","map","course","course_id","includes","catch","handleBuyClick","_ref3","_callee2","courseId","_callee2$","_context2","post","inProgress","_x","handleRemoveClick","className","children","src","image","alt","style","width","height","objectFit","title","price","onClick","disabled","backgroundColor"],"sources":["C:/Users/firas halouani/Desktop/design/Tadreex/frontend/src/components/cart/CartItem.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useShoppingCart } from \"../context/ShoppingCartContext\";\r\nimport FormatCurrency from \"../Admin/formation/FormatCurrency\";\r\nimport axios from \"axios\";\r\n\r\nconst CartItem = ({ id, quantity, company_id }) => {\r\n  const { removeFromCart } = useShoppingCart();\r\n  const [item, setItem] = useState(null);\r\n  const [isPurchased, setIsPurchased] = useState(false);\r\n  const [isDisabled, setIsDisabled] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const fetchItem = async () => {\r\n      try {\r\n        const response = await fetch(\r\n          `http://localhost:3000/training-courses/${id}`\r\n        );\r\n        if (!response.ok) {\r\n          throw new Error(\"Network response was not ok\");\r\n        }\r\n        const data = await response.json();\r\n        setItem(data);\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    };\r\n    fetchItem();\r\n\r\n    // Récupération des formations achetées par l'entreprise\r\n    axios.get(`http://localhost:3000/company/${company_id}/courses`)\r\n      .then((response) => {\r\n        const purchasedCourses = response.data.map((course) => course.course_id);\r\n        if (purchasedCourses.includes(id)) {\r\n          setIsPurchased(true);\r\n          setIsDisabled(true); // désactiver le bouton \"&times;\"\r\n        }\r\n      })\r\n      .catch((error) => {\r\n        console.error(error);\r\n      });\r\n  }, [id, company_id]);\r\n\r\n  const handleBuyClick = async (courseId) => {\r\n    try {\r\n      await axios.post(`http://localhost:3000/company/${company_id}/cours/${courseId}`, {\r\n        isPurchased: true,\r\n        inProgress: false,\r\n      });\r\n      setIsPurchased(true);\r\n      setIsDisabled(true); // désactiver le bouton \"&times;\"\r\n    } catch (error) {\r\n      console.error(error);\r\n    }\r\n  };\r\n  \r\n  const handleRemoveClick = (courseId) => {\r\n    if (!isDisabled && !isPurchased) { // Vérifier si le bouton \"&times;\" et le bouton \"Acheter\" sont activés\r\n      removeFromCart(courseId);\r\n    }\r\n  }  \r\n\r\n  if (item == null) return null;\r\n\r\n  return (\r\n    <div className=\"flex gap-2 items-center\">\r\n      <img\r\n        src={`http://localhost:3000/${item.image}`}\r\n        alt=\"cart-img\"\r\n        style={{ width: \"70px\", height: \"75px\", objectFit: \"cover\" }}\r\n      />\r\n      <div className=\"flex-grow\">\r\n        <div className=\"text-lg\">{item.title} </div>\r\n        <div className=\"text-gray-400 text-sm\"></div>\r\n      </div>\r\n      <div>{FormatCurrency(item.price * quantity)}</div>\r\n      {!isPurchased && (\r\n        <button\r\n          className=\"text-red-500 bg-transparent border border-red-500 rounded hover:bg-red-500 hover:text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500\"\r\n          onClick={() => handleRemoveClick(item.course_id)}\r\n          disabled={isDisabled}\r\n        >\r\n          &times;\r\n        </button>\r\n      )}      \r\n      <button\r\n        onClick={() => handleBuyClick(item.course_id)}\r\n        className=\"bg-green-500 hover:bg-green-700 text-white py-2 px-2 rounded\"\r\n        disabled={isPurchased}\r\n        style={{ backgroundColor: isPurchased ? \"#838996\" : \"\" }}\r\n      >\r\n        {isPurchased ? \"In progress\" : \"Demand\"}\r\n      </button>\r\n      <button\r\n        className=\"bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded\"\r\n      >\r\n        payer\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CartItem\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}